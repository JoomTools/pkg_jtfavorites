/**
 * @package      Joomla.Administrator
 * @subpackage   mod_jtfavorites
 *
 * @author       Guido De Gobbis <support@joomtools.de>
 * @copyright    2020 JoomTools.de - All rights reserved.
 * @license      GNU General Public License version 3 or later
 */
var JtFavorites=window.JtFavorites||{};function modJtFavReady(e){"loading"!=document.readyState?e():document.addEventListener("DOMContentLoaded",e)}!function(e,t){"use strict";e.sendData=function(e){var t=new XMLHttpRequest,n=new FormData(e);t.addEventListener("load",function(e){location.reload()}),t.addEventListener("error",function(e){console.error("mod_jtfavorites: Oops! Something went wrong on sending form data.")}),t.open("POST",e.getAttribute("action")),t.send(n)},e.submitform=function(n,a,r){a.addEventListener("submit",function(t){t.preventDefault(),e.sendData(a)}),n&&(a.task.value=n),a.noValidate=!r,r?a.hasAttribute("novalidate")&&a.removeAttribute("novalidate"):a.setAttribute("novalidate","");var i=t.createElement("input");i.style.display="none",i.type="submit",a.appendChild(i).click(),a.removeChild(i)},e.findAncestorForm=function(e){var n=e.match(/^[a-zA-Z]+/);return null!=n&&t.querySelector("#"+n.toString())},e.listItemTask=function(t,n){var a,r=e.findAncestorForm(t),i=0,o=r[t];if(!o)return!1;for(;a=r["cb"+i];)a.checked=!1,i++;o.checked=!0,r.boxchecked.value=1;var s=n.split(".",1);return r.setAttribute("action",r.getAttribute("data-"+s+"-action")),e.submitform(n,r),!1},e.changeListItemTask=function(){var e=t.querySelectorAll(".mod_jtfavorites *[onclick*=listItemTask]");Array.prototype.forEach.call(e,function(e){var t=e.getAttribute("onclick");e.setAttribute("onclick",t.replace("listItemTask","JtFavorites.listItemTask"))})},e.customActionsAddGetParams=function(){var e=t.querySelectorAll(".mod_jtfavorites .core .ext-link"),n=t.querySelectorAll(".mod_jtfavorites .click-action a[onclick*=checkin]"),a=window.Joomla.getOptions("csrf.token",""),r=t.createElement("style"),i=t.createElement("span"),o=t.createElement("span"),s=t.createElement("span");r.setAttribute("type","text/css"),r.appendChild(t.createTextNode(".spinner {\n  display: inline-block;\n  height: 14px;\n  vertical-align: middle;\n  line-height: 18px;\n  margin-right: 4px;\n}\n.spinner > span {\n  background-color: #333;\n  margin-left: 2px;\n  height: 100%;\n  width: 3px;\n  display: inline-block;\n  -webkit-animation: sk-stretchdelay 1.2s infinite ease-in-out;\n  animation: sk-stretchdelay 1.2s infinite ease-in-out;\n}\n.spinner .rect2 {\n  -webkit-animation-delay: -1.1s;\n  animation-delay: -1.1s;\n}\n.spinner .rect3 {\n  -webkit-animation-delay: -1.0s;\n  animation-delay: -1.0s;\n}\n@-webkit-keyframes sk-stretchdelay {\n  0%, 40%, 100% { -webkit-transform: scaleY(0.4) }  \n  20% { -webkit-transform: scaleY(1.0) }\n}\n@keyframes sk-stretchdelay {\n  0%, 40%, 100% { \n    transform: scaleY(0.4);\n    -webkit-transform: scaleY(0.4);\n  }  20% { \n    transform: scaleY(1.0);\n    -webkit-transform: scaleY(1.0);\n  }\n}")),t.head.appendChild(r),i.setAttribute("class","spinner"),i.setAttribute("aria-hidden","true"),i.innerHTML='<span class="rect1"></span><span class="rect2"></span><span class="rect3"></span>',s.setAttribute("class","icon-save"),s.setAttribute("aria-hidden","true"),o.setAttribute("class","error"),o.setAttribute("aria-hidden","true"),Array.prototype.forEach.call(e,function(e){var t=e.getAttribute("href");e.addEventListener("click",function(r){r.stopPropagation(),r.preventDefault(),e.parentNode.prepend(i),window.Joomla.request({url:t,headers:{"X-CSRF-Token":a},onError:function(e){console.error("ERROR: ",e)},onSuccess:function(t){var a;try{t=JSON.parse(t)}catch(e){t={succsess:!0}}e.parentNode.removeChild(i),!0===t.success&&(e.parentNode.prepend(s),a=s),!1===t.success&&(console.error("ERROR: ",t.message),o.innerHTML='<span style="color:red;">'+t.message+"</span>",e.parentNode.appendChild(o),a=o),Array.prototype.forEach.call(n,function(e){e.parentNode.removeChild(e)}),setTimeout(function(){e.parentNode.removeChild(a)},4e3)}})})})}}(JtFavorites,document),modJtFavReady(JtFavorites.changeListItemTask),modJtFavReady(JtFavorites.customActionsAddGetParams);